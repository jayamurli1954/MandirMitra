{"ast":null,"code":"/**\r\n * Export Utilities\r\n * Functions to export data to Excel/CSV\r\n */\n\n/**\r\n * Export donations to CSV\r\n */\nexport const exportDonationsToCSV = donations => {\n  // CSV Header\n  const headers = ['Receipt Number', 'Date', 'Devotee Name', 'Phone', 'Category', 'Amount', 'Payment Mode', 'Notes'];\n\n  // CSV Rows\n  const rows = donations.map(donation => [donation.receipt_number, donation.donation_date, donation.is_anonymous ? 'Anonymous' : donation.devotee_name, donation.devotee_phone || '', donation.category_name, donation.amount, donation.payment_mode, donation.notes || '']);\n\n  // Combine headers and rows\n  const csvContent = [headers.join(','), ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))].join('\\n');\n\n  // Create blob and download\n  const blob = new Blob([csvContent], {\n    type: 'text/csv;charset=utf-8;'\n  });\n  const link = document.createElement('a');\n  const url = URL.createObjectURL(blob);\n  link.setAttribute('href', url);\n  link.setAttribute('download', `donations_${new Date().toISOString().split('T')[0]}.csv`);\n  link.style.visibility = 'hidden';\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n};\n\n/**\r\n * Export report to CSV\r\n */\nexport const exportReportToCSV = (report, reportType = 'daily') => {\n  const headers = ['Category', 'Count', 'Amount', 'Percentage'];\n  const rows = report.by_category.map(item => [item.category, item.count, item.amount, report.total_amount > 0 ? (item.amount / report.total_amount * 100).toFixed(1) + '%' : '0%']);\n  const csvContent = [`Report Type: ${reportType}`, `Date: ${report.date || report.month}`, `Total Amount: ${report.total_amount}`, `Total Donations: ${report.total_donations}`, '', headers.join(','), ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))].join('\\n');\n  const blob = new Blob([csvContent], {\n    type: 'text/csv;charset=utf-8;'\n  });\n  const link = document.createElement('a');\n  const url = URL.createObjectURL(blob);\n  link.setAttribute('href', url);\n  link.setAttribute('download', `${reportType}_report_${report.date || report.month}.csv`);\n  link.style.visibility = 'hidden';\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n};","map":{"version":3,"names":["exportDonationsToCSV","donations","headers","rows","map","donation","receipt_number","donation_date","is_anonymous","devotee_name","devotee_phone","category_name","amount","payment_mode","notes","csvContent","join","row","cell","blob","Blob","type","link","document","createElement","url","URL","createObjectURL","setAttribute","Date","toISOString","split","style","visibility","body","appendChild","click","removeChild","exportReportToCSV","report","reportType","by_category","item","category","count","total_amount","toFixed","date","month","total_donations"],"sources":["D:/MandirSync/frontend/src/utils/exportUtils.js"],"sourcesContent":["/**\r\n * Export Utilities\r\n * Functions to export data to Excel/CSV\r\n */\r\n\r\n/**\r\n * Export donations to CSV\r\n */\r\nexport const exportDonationsToCSV = (donations) => {\r\n  // CSV Header\r\n  const headers = [\r\n    'Receipt Number',\r\n    'Date',\r\n    'Devotee Name',\r\n    'Phone',\r\n    'Category',\r\n    'Amount',\r\n    'Payment Mode',\r\n    'Notes',\r\n  ];\r\n\r\n  // CSV Rows\r\n  const rows = donations.map((donation) => [\r\n    donation.receipt_number,\r\n    donation.donation_date,\r\n    donation.is_anonymous ? 'Anonymous' : donation.devotee_name,\r\n    donation.devotee_phone || '',\r\n    donation.category_name,\r\n    donation.amount,\r\n    donation.payment_mode,\r\n    donation.notes || '',\r\n  ]);\r\n\r\n  // Combine headers and rows\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...rows.map((row) => row.map((cell) => `\"${cell}\"`).join(',')),\r\n  ].join('\\n');\r\n\r\n  // Create blob and download\r\n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n  const link = document.createElement('a');\r\n  const url = URL.createObjectURL(blob);\r\n  link.setAttribute('href', url);\r\n  link.setAttribute('download', `donations_${new Date().toISOString().split('T')[0]}.csv`);\r\n  link.style.visibility = 'hidden';\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n};\r\n\r\n/**\r\n * Export report to CSV\r\n */\r\nexport const exportReportToCSV = (report, reportType = 'daily') => {\r\n  const headers = ['Category', 'Count', 'Amount', 'Percentage'];\r\n  const rows = report.by_category.map((item) => [\r\n    item.category,\r\n    item.count,\r\n    item.amount,\r\n    report.total_amount > 0\r\n      ? ((item.amount / report.total_amount) * 100).toFixed(1) + '%'\r\n      : '0%',\r\n  ]);\r\n\r\n  const csvContent = [\r\n    `Report Type: ${reportType}`,\r\n    `Date: ${report.date || report.month}`,\r\n    `Total Amount: ${report.total_amount}`,\r\n    `Total Donations: ${report.total_donations}`,\r\n    '',\r\n    headers.join(','),\r\n    ...rows.map((row) => row.map((cell) => `\"${cell}\"`).join(',')),\r\n  ].join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n  const link = document.createElement('a');\r\n  const url = URL.createObjectURL(blob);\r\n  link.setAttribute('href', url);\r\n  link.setAttribute(\r\n    'download',\r\n    `${reportType}_report_${report.date || report.month}.csv`\r\n  );\r\n  link.style.visibility = 'hidden';\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n};\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}